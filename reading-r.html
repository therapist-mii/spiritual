<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>リーディングご予約フォーム | Therapist Mii</title>
    <!-- ファビコン -->
    <link rel="icon" href="https://github.com/therapist-mii/spiritual/raw/main/images/favicon.png" type="image/png">
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Noto Serif JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* カスタム設定 */
        :root {
            --color-primary: #776163; /* 文字を強調したいとき */
            --color-header: #EAE6E1;
            --color-button-normal: #E4C1B5;
            --color-button-hover: #ad9196;
            --color-clear-button: #7a736a;
            --color-error: #ff0000;
        }

        /* Noto Serif JPをデフォルトフォントに設定 */
        body {
            font-family: 'Noto Serif JP', serif;
            background-color: white;
            color: black;
            opacity: 0; /* JSでfadeInさせるために初期状態を非表示に */
        }
        
        /* 神秘的なふわっと表示 (Fade-in Animation) */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .fade-in-content {
            animation: fadeIn 1.2s ease-out forwards;
            animation-delay: 0.3s;
        }

        /* Tailwindカスタムテーマの拡張 */
        .tailwind-config {
            color: var(--color-primary);
            background-color: var(--color-header);
        }
        
        /* 必須項目マークのスタイル */
        .required-mark {
            color: var(--color-error);
            margin-left: 0.25rem;
        }
        
        /* カスタムモーダル */
        .modal {
            transition: opacity 0.3s ease-in-out;
            z-index: 1000;
        }
        .modal-overlay {
            background-color: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(2px);
        }
    </style>
    
    <script>
        // Tailwind CSSのカスタム設定
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary-text': 'var(--color-primary)',
                        'header-bg': 'var(--color-header)',
                        'btn-normal': 'var(--color-button-normal)',
                        'btn-hover': 'var(--color-button-hover)',
                        'clear-btn': 'var(--color-clear-button)',
                        'error-red': 'var(--color-error)',
                    },
                },
            },
        }
    </script>
</head>
<body class="min-h-screen pt-16" onload="document.body.style.opacity='1'">

    <!-- ヘッダー -->
    <header class="fixed top-0 left-0 w-full header-bg shadow-md z-50">
        <div class="max-w-3xl mx-auto px-4 py-3">
            <h1 class="text-2xl font-bold tracking-widest text-primary-text">Therapist Mii</h1>
        </div>
    </header>

    <!-- メインコンテンツ -->
    <main class="fade-in-content max-w-xl mx-auto p-4 md:p-8">
        <h2 class="text-3xl font-bold mb-8 text-center text-primary-text">リーディングご予約フォーム</h2>
        
        <p class="text-sm text-gray-600 mb-6 border-b pb-4">
            直感的に操作できるシンプルなフォームです。必須項目（<span class="required-mark">*</span>）をご記入の上、「LINEに貼り付けて予約する」ボタンでご予約を確定してください。
        </p>

        <!-- 基本料金表示 -->
        <div class="bg-header-bg p-4 rounded-xl shadow-inner mb-8">
            <p class="text-lg font-bold text-primary-text">料金</p>
            <p class="text-3xl font-bold text-right">18,000円</p>
        </div>

        <!-- フォーム本体 -->
        <form id="readingForm" class="space-y-8">
            
            <!-- 同意事項 -->
            <section class="form-section p-4 border border-gray-200 rounded-lg">
                <h3 class="text-xl font-bold mb-4 flex items-center">
                    同意事項<span class="required-mark text-error-red">*</span>
                </h3>
                <p class="text-sm text-gray-500 mb-3">ご予約には以下の事項への同意が必要です。</p>
                <div class="space-y-2 text-sm">
                    <label class="flex items-start cursor-pointer">
                        <input type="checkbox" id="consentPolicy" name="consentPolicy" class="mt-1 required-field h-4 w-4 text-primary-text border-gray-300 rounded focus:ring-primary-text">
                        <span class="ml-3 text-gray-700">セッションポリシー、注意事項に同意します。
                            <a href="https://spiritual-therapist-mii.studio.site/policy" target="_blank" class="text-primary-text hover:underline text-xs">(詳細はこちら)</a>
                        </span>
                    </label>
                    <label class="flex items-start cursor-pointer">
                        <input type="checkbox" id="consentNotAccepted" name="consentNotAccepted" class="mt-1 required-field h-4 w-4 text-primary-text border-gray-300 rounded focus:ring-primary-text">
                        <span class="ml-3 text-gray-700">お受けできないご相談を確認しました。
                            <a href="https://spiritual-therapist-mii.studio.site/policy#not-accepted-requests" target="_blank" class="text-primary-text hover:underline text-xs">(詳細はこちら)</a>
                        </span>
                    </label>
                    <label class="flex items-start cursor-pointer">
                        <input type="checkbox" id="consentPrivacy" name="consentPrivacy" class="mt-1 required-field h-4 w-4 text-primary-text border-gray-300 rounded focus:ring-primary-text">
                        <span class="ml-3 text-gray-700">プライバシーポリシーに同意します。
                            <a href="https://spiritual-therapist-mii.studio.site/privacypolicy" target="_blank" class="text-primary-text hover:underline text-xs">(詳細はこちら)</a>
                        </span>
                    </label>
                </div>
            </section>

            <!-- お名前 -->
            <section class="form-section">
                <label for="name" class="block text-xl font-bold mb-2">
                    お名前<span class="required-mark text-error-red">*</span>
                </label>
                <input type="text" id="name" name="name" placeholder="お名前" class="required-field w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200">
            </section>

            <!-- ご相談カテゴリと内容 (動的追加される部分) -->
            <div id="categoriesContainer" class="space-y-8">
                <!-- 1件目 (初期表示) -->
                <div class="category-group p-4 border border-header-bg rounded-lg shadow-sm">
                    <h4 class="text-lg font-bold mb-3 text-primary-text">
                        1件目
                    </h4>
                    <label for="category-1" class="block font-bold mb-2 text-sm">
                        ①ご相談カテゴリ<span class="required-mark text-error-red">*</span>
                    </label>
                    <p class="text-xs text-gray-500 mb-1">※お受けできないご相談をご確認ください。迷ったら、今いちばん近いものを1つお書きください。</p>
                    <input type="text" id="category-1" name="category-1" placeholder="カテゴリ名（例：仕事、長女の子育てについて、おまかせ など）" class="required-field category-input w-full p-3 border rounded-lg mb-4 focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200">

                    <label for="content-1" class="block font-bold mb-2 text-sm">
                        ご相談内容<span class="required-mark text-error-red">*</span>
                    </label>
                    <p class="text-xs text-gray-500 mb-1">ご相談内容を具体的にご記入ください。</p>
                    <textarea id="content-1" name="content-1" rows="5" class="required-field content-input w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200"></textarea>
                </div>
            </div>
            
            <!-- カテゴリ追加ボタン -->
            <div class="text-center">
                <button type="button" id="addCategoryBtn" class="bg-primary-text text-white px-6 py-3 rounded-full shadow-lg hover:bg-btn-hover transition duration-300 transform hover:scale-105 text-sm">
                    + 相談カテゴリを追加 (1,000円／1カテゴリ追加)
                </button>
            </div>

            <!-- お支払い方法 -->
            <section class="form-section">
                <label for="paymentMethod" class="block text-xl font-bold mb-2">
                    お支払い方法<span class="required-mark text-error-red">*</span>
                </label>
                <select id="paymentMethod" name="paymentMethod" class="required-field w-full p-3 border rounded-lg bg-white focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200">
                    <option value="" disabled selected>選択してください</option>
                    <option value="銀行振込">銀行振込</option>
                    <option value="Paypay">Paypay</option>
                    <option value="Paypal">Paypal</option>
                </select>
            </section>

            <!-- 備考 -->
            <section class="form-section">
                <label for="notes" class="block text-xl font-bold mb-2">備考</label>
                <p class="text-sm text-gray-500 mb-1">ご希望・ご質問があればご記入ください。</p>
                <textarea id="notes" name="notes" rows="3" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200"></textarea>
            </section>

            <!-- お見積り表示エリア -->
            <section class="form-section p-4 bg-header-bg rounded-xl shadow-inner mt-10">
                <h3 class="text-2xl font-bold mb-4 text-primary-text">お見積り</h3>
                <div id="estimateOutput" class="text-lg space-y-2">
                    <!-- JSでお見積り内容が挿入されます -->
                </div>
                <div class="mt-4 border-t border-gray-400 pt-4">
                    <p class="text-lg font-bold">【ご提出いただくもの】</p>
                    <ul class="list-disc list-inside ml-4 text-gray-700 text-sm mt-1">
                        <li>目元の写真</li>
                        <li>手書きのお名前</li>
                        <li>手書きの相談のタイトル</li>
                    </ul>
                </div>
            </section>

            <!-- LINE予約手順 -->
            <section class="mt-10 p-4 border border-dashed border-primary-text rounded-lg bg-white">
                <h3 class="text-xl font-bold text-primary-text mb-3">【LINEで予約する際の手順】</h3>
                <ol class="list-decimal list-inside space-y-2 text-gray-700">
                    <li>ご確認いただけましたら、<span class="font-bold">コピーボタン</span>を押してください。</li>
                    <li><span class="font-bold">「LINEに貼り付けて予約する」ボタン</span>を押し、起動したLINEに貼り付けて送信ください。</li>
                </ol>
            </section>
        </form>

        <!-- ページ下部機能ボタン -->
        <div class="flex flex-col space-y-4 mt-8">
            <!-- クリアボタン -->
            <button id="clearFormBtn" class="bg-clear-btn text-white px-6 py-4 rounded-full shadow-lg transition duration-300 transform hover:scale-[1.02] hover:bg-btn-normal font-bold">
                入力内容をクリア
            </button>
            
            <!-- コピーボタン -->
            <button id="copyBtn" class="bg-btn-normal text-white px-6 py-4 rounded-full shadow-lg transition duration-300 transform hover:scale-[1.02] hover:bg-btn-hover hover:text-white font-bold">
                入力内容をコピー
            </button>
            
            <!-- LINEで予約するボタン -->
            <button id="lineReserveBtn" class="bg-btn-normal text-white px-6 py-4 rounded-full shadow-lg transition duration-300 transform hover:scale-[1.05] hover:bg-btn-hover hover:text-white font-bold">
                LINEに貼り付けて予約する
            </button>
        </div>

    </main>

    <!-- フッター -->
    <footer class="mt-16 pt-10 pb-4 border-t border-gray-200 bg-header-bg">
        <div class="max-w-xl mx-auto px-4 space-y-8">
            
            <!-- はじめての方へセクション -->
            <section class="p-4 bg-white rounded-xl shadow-md border-t-4 border-primary-text">
                <h3 class="text-xl font-bold text-primary-text mb-3">はじめての方へ</h3>
                <p class="text-sm text-gray-700 mb-4">
                    はじめての方、またはリピーター様でも未入力の方は、以下のフォームにご記入をお願いいたします。
                </p>
                <a href="https://spiritual-therapist-mii.studio.site/form" target="_blank" class="block text-center bg-btn-normal text-white px-6 py-3 rounded-full shadow-md hover:bg-btn-hover transition duration-300 font-bold text-sm">
                    はじめての方のフォーム
                </a>
            </section>

            <!-- ナビゲーションリンク -->
            <nav class="grid grid-cols-2 sm:grid-cols-4 gap-3 text-sm text-center">
                <a href="https://spiritual-therapist-mii.studio.site/" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">HOME</a>
                <a href="https://spiritual-therapist-mii.studio.site/menu" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">メニュー一覧</a>
                <a href="https://spiritual-therapist-mii.studio.site/reading" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">リーディング</a>
                <a href="https://spiritual-therapist-mii.studio.site/mirai-navi" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">未来ナビ</a>
                <a href="https://spiritual-therapist-mii.studio.site/art-therapy" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">アートセラピー</a>
                <a href="https://spiritual-therapist-mii.studio.site/color-card" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">カラーカード</a>
                <a href="https://spiritual-therapist-mii.studio.site/healing" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">ヒーリング</a>
                <a href="https://spiritual-therapist-mii.studio.site/f2f_reading" class="text-gray-700 hover:text-primary-text transition duration-200 border-b border-dashed pb-1">対面リーディング</a>
            </nav>

            <!-- 著作権 -->
            <p class="text-xs text-center text-gray-500 pt-4">
                © 2025 by Therapist Mii. All rights reserved.
            </p>
        </div>
    </footer>
    
    <!-- カスタムモーダル (バリデーションエラー/コピー完了メッセージ用) -->
    <div id="customModal" class="modal fixed inset-0 flex items-center justify-center hidden">
        <div class="modal-overlay absolute inset-0"></div>
        <div class="modal-content bg-white p-6 rounded-xl shadow-2xl w-11/12 max-w-sm transform scale-95 opacity-0 transition-all duration-300 relative z-100">
            <h3 id="modalTitle" class="text-xl font-bold mb-3 text-primary-text"></h3>
            <p id="modalMessage" class="mb-5 text-gray-700"></p>
            <button id="closeModalBtn" class="w-full bg-btn-normal text-white py-2 rounded-full hover:bg-btn-hover transition duration-200">閉じる</button>
        </div>
    </div>

    <script>
        const CATEGORY_PRICE = 1000;
        const BASE_PRICE = 18000;
        let categoryCount = 1;
        const categoriesContainer = document.getElementById('categoriesContainer');
        const addCategoryBtn = document.getElementById('addCategoryBtn');
        const estimateOutput = document.getElementById('estimateOutput');
        const readingForm = document.getElementById('readingForm');
        const copyBtn = document.getElementById('copyBtn');
        const lineReserveBtn = document.getElementById('lineReserveBtn');
        const clearFormBtn = document.getElementById('clearFormBtn');
        
        // モーダル要素
        const modal = document.getElementById('customModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const closeModalBtn = document.getElementById('closeModalBtn');

        // モーダル表示関数
        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modal.classList.remove('hidden');
            
            // アニメーション
            const content = modal.querySelector('.modal-content');
            setTimeout(() => {
                content.classList.add('scale-100', 'opacity-100');
                content.classList.remove('scale-95', 'opacity-0');
            }, 10);
        }

        // モーダル非表示関数
        function closeModal() {
            const content = modal.querySelector('.modal-content');
            content.classList.add('scale-95', 'opacity-0');
            content.classList.remove('scale-100', 'opacity-100');
            setTimeout(() => {
                modal.classList.add('hidden');
            }, 300);
        }

        closeModalBtn.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => {
            if (e.target.classList.contains('modal-overlay')) {
                closeModal();
            }
        });

        // お見積りの更新
        function updateEstimate() {
            const totalCategories = readingForm.querySelectorAll('.category-group').length;
            const additionalCategories = totalCategories > 1 ? totalCategories - 1 : 0;
            const additionalFee = additionalCategories * CATEGORY_PRICE;
            const totalAmount = BASE_PRICE + additionalFee;

            const estimateHTML = `
                <p>リーディング 1件：18,000 円</p>
                <p>カテゴリ追加料：${additionalCategories}件 × ${CATEGORY_PRICE.toLocaleString()}円 = ${additionalFee.toLocaleString()} 円</p>
                <div class="border-t border-gray-400 my-2"></div>
                <p class="text-2xl font-bold text-right text-primary-text">合計金額：${totalAmount.toLocaleString()} 円</p>
            `;
            estimateOutput.innerHTML = estimateHTML;
        }

        // カテゴリ追加機能
        function addCategory() {
            categoryCount++;
            const newCategoryHTML = `
                <div class="category-group p-4 border border-header-bg rounded-lg shadow-sm">
                    <h4 class="text-lg font-bold mb-3 text-primary-text">
                        ${categoryCount}件目 <button type="button" class="remove-category-btn text-error-red text-xs font-normal ml-2 hover:opacity-75">[削除]</button>
                    </h4>
                    <label for="category-${categoryCount}" class="block font-bold mb-2 text-sm">
                        ご相談カテゴリ<span class="required-mark text-error-red">*</span>
                    </label>
                    <p class="text-xs text-gray-500 mb-1">※お受けできないご相談をご確認ください。迷ったら、今いちばん近いものを1つお書きください。</p>
                    <input type="text" id="category-${categoryCount}" name="category-${categoryCount}" placeholder="カテゴリ名（例：仕事、長女の子育てについて、おまかせ など）" class="required-field category-input w-full p-3 border rounded-lg mb-4 focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200">

                    <label for="content-${categoryCount}" class="block font-bold mb-2 text-sm">
                        ご相談内容<span class="required-mark text-error-red">*</span>
                    </label>
                    <p class="text-xs text-gray-500 mb-1">ご相談内容を具体的にご記入ください。</p>
                    <textarea id="content-${categoryCount}" name="content-${categoryCount}" rows="5" class="required-field content-input w-full p-3 border rounded-lg focus:ring-2 focus:ring-primary-text focus:border-primary-text transition duration-200"></textarea>
                </div>
            `;
            categoriesContainer.insertAdjacentHTML('beforeend', newCategoryHTML);
            updateEstimate();
        }

        // カテゴリ削除機能
        categoriesContainer.addEventListener('click', function(e) {
            if (e.target.classList.contains('remove-category-btn')) {
                if (readingForm.querySelectorAll('.category-group').length > 1) {
                    e.target.closest('.category-group').remove();
                    // カテゴリ番号を振り直す（ユーザー体験向上のため）
                    readingForm.querySelectorAll('.category-group').forEach((group, index) => {
                        group.querySelector('h4').innerHTML = `${index + 1}件目 <button type="button" class="remove-category-btn text-error-red text-xs font-normal ml-2 hover:opacity-75">[削除]</button>`;
                    });
                    categoryCount = readingForm.querySelectorAll('.category-group').length;
                    updateEstimate();
                } else {
                    showModal('削除できません', 'カテゴリは最低1件必要です。');
                }
            }
        });

        addCategoryBtn.addEventListener('click', addCategory);

        // フォーム入力時のイベントリスナーを設定して、リアルタイムでお見積りを更新
        readingForm.addEventListener('input', updateEstimate);

        // 入力チェック (バリデーション)
        function validateForm() {
            let isValid = true;
            const requiredFields = document.querySelectorAll('.required-field');
            
            // エラー表示をリセット
            requiredFields.forEach(field => {
                field.style.borderColor = '';
                field.style.boxShadow = '';
            });

            requiredFields.forEach(field => {
                let isFieldValid = true;

                if (field.type === 'checkbox') {
                    if (!field.checked) {
                        isFieldValid = false;
                        // チェックボックスは親要素の枠を赤くする
                        field.closest('.form-section').style.borderColor = 'var(--color-error)';
                        field.closest('.form-section').style.boxShadow = '0 0 0 1px var(--color-error)';
                    }
                } else if (field.tagName === 'SELECT') {
                    if (field.value === "") {
                        isFieldValid = false;
                    }
                } else if (field.value.trim() === '') {
                    isFieldValid = false;
                }

                if (!isFieldValid) {
                    isValid = false;
                    // テキスト/セレクトボックスは自身の枠を赤くする
                    if (field.type !== 'checkbox') {
                        field.style.borderColor = 'var(--color-error)';
                        field.style.boxShadow = '0 0 0 1px var(--color-error)';
                    }
                }
            });

            if (!isValid) {
                showModal('必須項目にご記入ください', 'お手数ですが、赤い枠で示された全ての必須項目を正しくご入力ください。');
            }
            return isValid;
        }

        // コピー内容の整形
        function formatCopyContent() {
            const name = document.getElementById('name').value.trim();
            const paymentMethod = document.getElementById('paymentMethod').value;
            const notes = document.getElementById('notes').value.trim();
            
            let categoriesData = [];
            readingForm.querySelectorAll('.category-group').forEach((group, index) => {
                const category = group.querySelector('.category-input').value.trim();
                const content = group.querySelector('.content-input').value.trim();
                categoriesData.push({ index: index + 1, category, content });
            });

            const totalCategories = categoriesData.length;
            const additionalCategories = totalCategories > 1 ? totalCategories - 1 : 0;
            const additionalFee = additionalCategories * CATEGORY_PRICE;
            const totalAmount = BASE_PRICE + additionalFee;

            let content = `リーディング希望\n\n`;
            content += `【お名前】\n${name}\n\n`;
            
            categoriesData.forEach(data => {
                content += `${data.index}件目\n`;
                content += `【ご相談カテゴリ】\n${data.category}\n`;
                content += `【ご相談内容】\n${data.content}\n\n`;
            });
            
            content += `【お支払い方法】\n${paymentMethod}\n\n`;
            
            if (notes) {
                content += `【ご希望・ご質問（備考）】\n${notes}\n\n`;
            }

            content += `\n--- お見積り ---\n`;
            content += `リーディング 1件：18,000 円\n`;
            content += `カテゴリ追加料：${additionalCategories}件 × ${CATEGORY_PRICE.toLocaleString()}円 = ${additionalFee.toLocaleString()} 円\n`;
            content += `--------------------------------\n`;
            content += `合計金額：${totalAmount.toLocaleString()} 円\n`;
            content += `--------------------------------\n\n`;
            
            content += `【ご提出いただくもの】\n`;
            content += `目元の写真\n`;
            content += `手書きのお名前\n`;
            content += `手書きの相談のタイトル\n`;

            return content;
        }

        // クリップボードにコピー
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showModal('コピーが完了しました', '入力内容をクリップボードにコピーしました。LINEに貼り付けて送信してください。');
                } else {
                    showModal('コピー失敗', 'コピーに失敗しました。お手数ですが、内容を手動でコピーしてください。');
                }
            } catch (err) {
                showModal('コピー失敗', 'コピーに失敗しました。お手数ですが、内容を手動でコピーしてください。');
            }
            document.body.removeChild(textarea);
        }

        // コピーボタン処理
        copyBtn.addEventListener('click', function() {
            if (validateForm()) {
                const content = formatCopyContent();
                copyToClipboard(content);
            }
        });

        // LINE予約ボタン処理
        lineReserveBtn.addEventListener('click', function() {
            if (validateForm()) {
                const content = formatCopyContent();
                copyToClipboard(content); // まずコピーを実行
                
                // LINEアプリを起動
                setTimeout(() => {
                    window.open('https://line.me/ti/p/Kv76GQK_UI', '_blank');
                }, 500); // コピー完了メッセージが表示されるのを少し待つ
            }
        });

        // クリアボタン処理
        clearFormBtn.addEventListener('click', function() {
            readingForm.reset();
            // 動的追加されたカテゴリを削除して初期状態に戻す
            while (categoriesContainer.children.length > 1) {
                categoriesContainer.removeChild(categoriesContainer.lastChild);
            }
            categoryCount = 1;
            // エラー表示のリセット
            document.querySelectorAll('.required-field').forEach(field => {
                field.style.borderColor = '';
                field.style.boxShadow = '';
            });
            document.querySelectorAll('.form-section').forEach(section => {
                section.style.borderColor = '';
                section.style.boxShadow = '';
            });
            updateEstimate();
            showModal('入力内容をクリア', 'フォームの内容をすべて消去しました。');
        });

        // 初期表示時のお見積り更新
        updateEstimate();
    </script>
</body>
</html>