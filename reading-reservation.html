<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>スピリチュアルセラピスト未依 - リーディングお見積り＆ご予約</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Shippori+Mincho:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* CSSカスタムプロパティでカラーパレットを定義 */
        :root {
            --color-accent: #E4C1B5; /* アクセントカラー */
            --color-accent-darker: #ccac9c; /* アクセントカラーの少し濃い色（ホバー用） */
            --color-base: #EAE6E1; /* ベースカラー */
            --color-text: #544C40; /* テキストカラー */
            --color-text-light: #7a736a; /* テキストカラーの少し薄い色 */
            --color-accent-rgb: 228, 193, 181; /* アクセントカラーのRGB値（透過色用） */
        }

        /* Shippori Minchoフォントの指定と、ベースカラー・テキストカラーの適用 */
        body {
            font-family: 'Shippori Mincho', serif; /* 明朝系のフォントに変更 */
            line-height: 1.6;
            margin: 0;
            padding: 0;
            color: var(--color-text); /* テキストカラーを適用 */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            /* PC版の背景画像を設定 (はじめての方へ からコピー) */
            background-image: url('https://github.com/therapist-mii/spiritual/raw/main/images/haikei.jpg');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
        }

        /* スマートフォン版の背景画像を設定 (はじめての方へ からコピー) */
        @media (max-width: 768px) {
            body {
                background-image: url('https://github.com/therapist-mii/spiritual/raw/main/images/haikei-sumaho.jpg'); /* スマートフォン用の画像 */
                background-size: cover;
                background-position: center;
                background-attachment: fixed;
            }
        }

        /* カスタムアニメーション (既存サイトから継承) - body背景との統一感を考慮しつつ残す */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .fade-in-on-scroll {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 2s ease-out, transform 2s ease-out;
        }
        .fade-in-on-scroll.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Off-canvas menu styles (既存サイトから継承) */
        .off-canvas-menu {
            position: fixed;
            top: 0;
            right: -250px;
            width: 250px;
            height: 100%;
            background-color: var(--color-base);
            box-shadow: -2px 0 5px rgba(0,0,0,0.2);
            transition: right 0.3s ease-in-out;
            z-index: 1000;
            color: var(--color-text);
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .off-canvas-menu.open {
            right: 0;
        }
        .off-canvas-menu ul {
            list-style: none;
            padding: 0;
            margin: 0;
            width: 100%;
        }
        .off-canvas-menu ul li a {
            display: block;
            padding: 1rem 1.5rem;
            text-decoration: none;
            color: var(--color-text);
            font-weight: 500;
            transition: background-color 0.3s ease;
            text-align: center;
        }
        .off-canvas-menu ul li a:hover {
            background-color: rgba(var(--color-accent-rgb),0.1);
            color: var(--color-accent);
        }
        .close-btn {
            position: absolute;
            top: 1rem;
            left: 1rem;
            font-size: 2rem;
            cursor: pointer;
            color: var(--color-text);
        }
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease;
        }
        .overlay.open {
            opacity: 1;
            visibility: visible;
        }

        /* 既存のbooking-reading.htmlとstyle.cssの主要スタイルを統合 */
        h1, h2 {
            text-align: center;
            color: var(--color-text); /* サイトのテキストカラーに合わせる */
        }
        h1 {
            margin-top: 20px;
            margin-bottom: 30px;
            font-size: 6em; /* リーディングお見積り＆ご予約のフォントサイズをさらに大きく変更 */
            font-weight: bold; /* 太字に設定 */
        }

        /* Form Container - はじめての方へ に合わせて透明感のある背景に */
        form {
            background-color: rgba(255, 255, 255, 0.5);
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            max-width: 700px;
            width: 90%;
            margin-bottom: 30px;
            box-sizing: border-box;
            margin-left: auto; /* Ensure form is centered within main */
            margin-right: auto; /* Ensure form is centered within main */
        }

        /* Input Group Styles - はじめての方へ に合わせて透明感のある背景に */
        .input-group {
            margin-bottom: 25px;
            padding: 15px;
            border: 1px solid var(--color-accent); /* アクセントカラーのボーダー */
            border-radius: 8px;
            background-color: rgba(255, 255, 255, 0.7); /* 透明感のある背景に */
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: var(--color-text); /* サイトのテキストカラーに合わせる */
            font-size: 1.1em;
        }
        .input-group .note {
            font-size: 0.9em;
            color: var(--color-text-light); /* サイトのテキストカラーに合わせる */
            margin-bottom: 10px;
            line-height: 1.4;
        }
        .input-group .note-price {
            font-size: 0.9em;
            color: var(--color-text); /* サイトのテキストカラーに合わせる */
            font-weight: bold;
            margin-bottom: 15px;
            border-bottom: 1px dashed var(--color-accent); /* アクセントカラーの点線 */
            padding-bottom: 5px;
        }

        /* 霊視接続料を非表示にするためのスタイル */
        .hide-fee {
            display: none;
        }

        /* Input, Select, Textarea Styles */
        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--color-accent); /* アクセントカラーのボーダー */
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 1em;
            background-color: #fcfcfc;
            margin-bottom: 10px;
            color: var(--color-text); /* サイトのテキストカラーに合わせる */
        }
        textarea {
            resize: vertical;
            min-height: 80px;
        }
        input:focus, select:focus, textarea:focus {
            border-color: var(--color-accent-darker); /* サイトのアクセントカラーに合わせる */
            outline: none;
            box-shadow: 0 0 8px rgba(var(--color-accent-rgb), 0.6);
        }

        /* Dynamic Lists and Items */
        .dynamic-list { margin-bottom: 15px; }
        .dynamic-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }
        .dynamic-item input { flex-grow: 1; margin-bottom: 0; }

        /* Add & Remove Buttons */
        .add-item-btn {
            background-color: var(--color-accent); /* サイトのアクセントカラーに合わせる */
            color: white;
            border: none;
            border-radius: 5px;
            padding: 8px 15px;
            cursor: pointer;
            font-size: 0.9em;
            margin-top: 5px;
        }
        .add-item-btn:hover { background-color: var(--color-accent-darker); }
        .remove-item {
            background-color: var(--color-text-light); /* 明るいテキストカラー */
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            flex-shrink: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2em; /* バツ印を見やすく */
        }
        .remove-item:hover { background-color: var(--color-text); } /* 濃いテキストカラー */


        .controls-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 10px;
        }
        .qty-display { font-weight: bold; color: var(--color-text); }

        /* Quantity Controls */
        .controls.option { display: flex; align-items: center; gap: 10px; flex-wrap: wrap; }
        .controls.option .price { font-weight: bold; min-width: 80px; text-align: right; color: var(--color-text); }
        .controls.option button {
            background-color: var(--color-accent); /* サイトのアクセントカラーに合わせる */
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .controls.option button:hover:not(:disabled) { background-color: var(--color-accent-darker); }
        .controls.option button:disabled { background-color: #cccccc; cursor: not-allowed; }
        .controls.option input[type="number"] { width: 50px; text-align: center; margin: 0; -moz-appearance: textfield; }
        .controls.option input[type="number"]::-webkit-inner-spin-button { -webkit-appearance: none; }
        .controls.option .qty { margin-left: 10px; font-weight: bold; color: var(--color-text); }

        /* Section Titles */
        .section-title {
            text-align: center;
            margin-top: 40px;
            margin-bottom: 25px;
            font-size: 1.6em;
            border-bottom: 2px solid var(--color-accent); /* アクセントカラーのボーダー */
            padding-bottom: 10px;
            color: var(--color-text);
        }

        /* Coupon & Confirmation */
        /* ご確認事項セクションの背景色とタイトルの色を変更 */
        .confirmation-group {
            background-color: rgba(var(--color-accent-rgb), 0.08); /* アクセントカラーの薄い透過色 */
            border: 1px solid var(--color-accent); /* アクセントカラーで枠線 */
            padding: 25px; /* Adjust padding */
            border-radius: 10px; /* Keep rounded corners */
            margin-bottom: 25px; /* Consistent margin */
        }
        .confirmation-title {
            font-size: 1.3em;
            font-weight: bold;
            color: var(--color-accent); /* アクセントカラーに変更 */
            text-align: center;
            margin-bottom: 15px; /* Adjust margin */
        }
        .confirmation-item {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px dotted rgba(var(--color-text-rgb), 0.2); /* テキストカラーの薄い点線 */
        }
        .agree-final { font-weight: bold; display: block; margin-top: 15px; color: var(--color-text); }

        /* Estimate Section */
        .estimate { background-color: rgba(255, 255, 255, 0.8); /* 透明感のある背景に */ border: 1px solid var(--color-accent); padding: 20px; margin-top: 30px; }
        .estimate-title { font-size: 1.3em; font-weight: bold; text-align: center; color: var(--color-text); }
        .estimate-items { list-style: none; padding: 0; }
        .estimate-items li { display: flex; justify-content: space-between; padding: 5px 0; border-bottom: 1px dotted var(--color-text-light); }
        .estimate-total { margin-top: 20px; border-top: 2px solid var(--color-accent); padding-top: 15px; text-align: right; font-size: 1.4em; font-weight: bold; color: var(--color-text); }
        .estimate-total #totalAmount { color: var(--color-accent-darker); /* アクセントカラーで強調 */ font-size: 1.2em; }

        /* Buttons */
        .center-btn { 
            text-align: center; 
            margin-top: 30px; 
            display: flex; 
            gap: 15px; 
            justify-content: center; 
            flex-wrap: wrap;
            flex-direction: column; /* ボタンと説明文を縦に並べるために追加 */
            align-items: center; /* 中央揃えのために追加 */
        }
        .center-btn button, .center-btn a {
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            font-size: 1.1em;
            cursor: pointer;
            text-decoration: none;
            flex-grow: 1; /* ボタンが伸びるように */
            max-width: 400px; /* 最大幅を設定 */
            width: 100%; /* 親要素に合わせて幅を確保 */
            box-sizing: border-box; /* パディングを幅に含める */
            margin-bottom: 5px; /* ボタン間のスペースを調整 */
        }
        .center-btn button#copyBtn { background-color: var(--color-accent); } /* サイトのアクセントカラーに合わせる */
        .center-btn button#copyBtn:hover { background-color: var(--color-accent-darker); }
        .center-btn button#clearBtn { background-color: var(--color-text-light); } /* はじめての方へ と同じに */
        .center-btn button#clearBtn:hover { background-color: var(--color-text); } /* はじめての方へ と同じに */

        /* 新しい説明文のスタイル */
        .line-instructions-container {
            text-align: center;
            font-size: 0.9em;
            color: var(--color-text-light);
            margin-top: 10px; /* ボタンとの間隔 */
            line-height: 1.4;
        }
        .line-instructions-container p {
            margin-bottom: 5px;
        }

        /* LINE送信用ボタンの色 (既存スタイルを継承) */
        .line-btn-wrapper {
            margin-top: 30px; /* はじめての方へ と同じマージン */
            display: flex; /* Flexboxを適用 */
            flex-direction: column; /* スマートフォンでは縦に並べる */
            gap: 15px; /* ボタン間の余白 */
            justify-content: center;
            align-items: center; /* 中央寄せ */
        }
        @media (min-width: 768px) { /* デスクトップでは横に並べる */
            .line-btn-wrapper {
                flex-direction: row;
            }
        }
        .line-button {
            background-color: #00c300;
            color: white;
            padding: 15px 30px;
            border-radius: 5px;
            font-size: 1.1em;
            text-decoration: none;
            display: inline-block;
            width: 100%; /* center-btnのmax-widthと合わせて適切に表示されるように */
            max-width: 400px; /* はじめての方へ と同じに */
            box-sizing: border-box;
            transition: background-color 0.3s ease;
        }
        .line-button:hover { background-color: #009900; }

        /* First-time User & Home Button */
        .first-time-user-section { 
            background-color: rgba(255, 255, 255, 0.5); /* 透明度を0.5に変更 */
            padding: 30px; 
            border-radius: 10px; 
            max-width: 700px; 
            width: 90%; 
            margin-top: 60px; 
            text-align: center; 
            box-sizing: border-box; 
        }
        /* .home-button は削除したので不要だが、念のためコメントアウトで残す */
        /* .home-button { text-align: center; margin: 40px auto; } */

        .form-button { 
            background-color: var(--color-text) !important; /* はじめての方へ ボタンカラーに合わせる */
            color: white; 
            padding: 15px 30px; 
            border-radius: 5px; 
            text-decoration: none; 
            display: inline-block; 
            transition: background-color 0.3s ease;
        }
        .form-button:hover { 
            background-color: var(--color-text-light) !important; 
        }
        .home-button {
            text-align: center;
            margin: 40px auto;
        }
        .home-button a {
            background-color: var(--color-accent); /* ヒーリングページと統一 */
            color: white;
            padding: 15px 30px;
            border-radius: 5px;
            font-size: 1.1em;
            text-decoration: none;
            display: inline-block;
            transition: background-color 0.3s ease;
        }
        .home-button a:hover {
            background-color: var(--color-accent-darker);
        }

        /* Validation & Error Styles */
        .asterisk { color: red; margin-left: 5px; }
        .error-highlight { border: 2px solid #ff9999 !important; background-color: #fffafa !important; }
        #validation-message { color: red; font-weight: bold; margin-top: 15px; text-align: center; display: none; }


        /* Responsive Design */
        @media (max-width: 768px) {
            h1 { font-size: 3.5em; } /* モバイルでも調整 */
            form, .first-time-user-section { padding: 20px; width: 95%; }
            .center-btn { flex-direction: column; align-items: center; }
            .center-btn button, .center-btn a { width: 100%; max-width: 300px; } /* スマホでのボタン幅調整 */
            .question-block .controls { flex-direction: column; align-items: stretch; }
            .question-block .remove-item { align-self: flex-end; margin-top: 5px; }
            .off-canvas-menu { width: 100%; right: -100%; } /* スマホで全画面開くように */
        }

        /* ％OFFクーポン入力ボックスの幅を調整 */
        .percent-coupon-label input[type="number"] {
            width: 3.5em; /* 全角3文字分くらいの幅（調整可能） */
            max-width: 80px; /* 必要に応じて最大幅を設定 */
            box-sizing: border-box; /* パディングとボーダーを幅に含める */
        }
    </style>
</head>
<body>

    <!-- ヘッダーとナビゲーションバー -->
    <header class="bg-white shadow-lg h-20 sticky top-0 z-50 w-full">
        <nav class="container mx-auto flex flex-row justify-between items-center h-full max-w-4xl px-4 sm:px-6 lg:px-8">
            <!-- ロゴのみ -->
            <div class="flex items-center h-full">
                <a href="index.html#home">
                    <img src="https://github.com/therapist-mii/spiritual/raw/main/images/rogo-64.png" onerror="this.onerror=null;this.src='https://placehold.co/100x100/CCCCCC/000000?text=Logo';" alt="サイトロゴ" class="h-full w-auto object-contain">
                </a>
            </div>
            <!-- ハンバーガーメニューアイコン -->
            <div>
                <button id="menu-toggle" class="text-[var(--color-text)] focus:outline-none">
                    <i class="fas fa-bars text-2xl"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- Off-canvas menu -->
    <div id="off-canvas-menu" class="off-canvas-menu">
        <span class="close-btn" id="close-menu">&times;</span>
        <ul>
            <li><a href="index.html#home">HOME</a></li>
            <li><a href="menu.html">メニュー</a></li>
            <li><a href="reservation.html">予約</a></li>
            <li><a href="index.html#customer-voice">お客様の声</a></li>
            <li><a href="index.html#links">リンク</a></li>
            <li><a href="index.html#blog">ブログ</a></li>
            <li><a href="index.html#qna">Q＆A</a></li>
            <li><a href="index.html#contact">お問合わせ</a></li>
        </ul>
    </div>

    <!-- Overlay for when menu is open -->
    <div id="menu-overlay" class="overlay"></div>

    <main class="container mx-auto px-4 sm:px-6 lg:px-8 max-w-2xl my-12 fade-in-on-scroll">
        <h1>リーディングお見積り＆ご予約</h1>
        <!-- 新しい説明文の追加 -->
        <p class="mt-10" style="text-align:center; font-weight:bold; color:var(--color-accent-darker); margin-bottom:30px;">
          必要事項を記入してください。<br>
          一番下に見積もりが出ます。
        </p>
        

        <form id="reservationForm">

            <div id="inputs">
                <div class="input-group">
                    <label class="required">お名前<span class="asterisk">*</span></label>
                    <div class="note-price hide-fee">霊視接続料　13,000円</div> <!-- 非表示にするクラスを追加 -->
                    <input type="text" placeholder="お名前" name="requester_name" id="requesterNameInput" required>
                </div>

                <div class="input-group">
                    <label class="required">ご相談内容<span class="asterisk">*</span></label>
                    <div class="note">ご相談の要点をご記入ください。詳細はLINEにてお知らせいただけます。<br>（カテゴリ選択と内容記入の両方が必須です。）</div>
                    <div id="questionList" class="question-list dynamic-list">
                        <div class="question-block">
                            <div class="input-group-sub">
                                <label for="consultation-category-0" class="required">近いカテゴリをお選びください<span class="asterisk">*</span></label>
                                <select class="consultation-category" name="category_0" id="consultation-category-0" required>
                                    <option value="">選択してください</option>
                                    <option value="仕事" data-price="3000">仕事</option>
                                    <option value="中規模以上の経営" data-price="13000">中規模以上の経営</option>
                                    <option value="家族関係" data-price="3000">家族関係</option>
                                    <option value="人間関係" data-price="5000">人間関係</option>
                                    <option value="恋愛感情" data-price="8000">恋愛感情</option>
                                    <option value="健康" data-price="8000">健康</option>
                                    <option value="上記に該当しない" data-price="3000">上記に該当しない</option>
                                </select>
                            </div>
                            <div class="controls">
                                <textarea rows="2" data-label="ご相談内容" placeholder="相談内容の要点のみご記入ください。" name="question_0" required></textarea>
                            </div>
                        </div>
                    </div>
                    <button type="button" id="addQuestionBtn" class="add-item-btn">＋ 相談内容を追加</button>
                </div>
            </div>

            <div class="input-group">
                <label class="required">関係者のお名前<span class="asterisk">*</span></label>
                <div class="note">鑑定結果に言及する必要のある方のお名前。最大5名まで</div>
                <div class="note-price">関係者の霊視接続料：3,000円/1名</div>
                <div id="relatedNameList" class="dynamic-list">
                </div>
                <div style="margin-top:10px;">
                    <input type="checkbox" id="noRelatedCheckbox" name="no_related">
                    <label for="noRelatedCheckbox">関係者はいません</label>
                </div>
                <div id="relatedError" style="color: red; display: none; margin-top: 10px;">
                    関係者名を追加するか、「関係者はいません」にチェックしてください。
                </div>
                <div class="controls-footer">
                    <button type="button" id="addRelatedNameBtn" class="add-item-btn">＋ 関係者を追加</button>
                    <span class="qty-display">人数: <strong id="relatedNameCount">0</strong></span>
                </div>
            </div>

            <h2 class="section-title">オプション</h2>
            <div id="options">
                <div class="input-group option-block">
                    <label>筆跡診断</label>
                    <div class="description">文字の癖から思考傾向や内面のブロックを診断します。</div>
                    <div class="controls option">
                        <span class="price">6,000円</span>
                        <button type="button" class="minus">−</button>
                        <input type="number" min="0" value="0" data-price="6000" data-label="筆跡診断" name="handwriting_qty">
                        <button type="button" class="plus">＋</button>
                        <span class="qty">数量: <strong>0</strong></span>
                    </div>
                </div>

                <div class="input-group option-block">
                    <label>お顔オーラカラーマップ</label>
                    <div class="description">お顔に現れるエネルギー傾向をカラーマップで可視化します。</div>
                    <div class="controls option">
                        <span class="price">4,000円</span>
                        <button type="button" class="minus">−</button>
                        <input type="number" min="0" value="0" data-price="4000" data-label="お顔オーラカラーマップ" name="aura_map_qty">
                        <button type="button" class="plus">＋</button>
                        <span class="qty">数量: <strong>0</strong></span>
                    </div>
                </div>

                <div class="input-group option-block">
                    <label>ライト割引</label>
                    <div class="light-discount-description">
                        <ul>
                            <li>A4用紙1枚程度の量の鑑定書のみ</li>
                            <li>詳細な説明はありません。</li>
                            <li>納品後のLINEは、お気持ちだけいただき、基本的にこちらからのご返信は控えさせていただきます。</li>
                        </ul>
                    </div>
                    <label class="light-discount-agree">
                        <input type="checkbox" id="agree-light-discount"> 上記内容に同意し、ライト割引を適用します
                    </label>
                    <div class="controls option">
                        <span class="price">-3,000円</span>
                        <button type="button" class="minus" disabled>−</button>
                        <input type="number" min="0" max="1" value="0" data-price="-3000" data-label="ライト割引" disabled name="light_discount_qty">
                        <button type="button" class="plus" disabled>＋</button>
                        <span class="qty">数量: <strong>0</strong></span>
                    </div>
                </div>
            </div>

            <h2 class="section-title">お支払いについて</h2>
            <div class="additional-sections">
                <div class="input-group">
                    <label class="required">クーポンお持ちの方は入力してください。<span class="asterisk">*</span></label>
                    <div id="coupon-group" class="coupon-options">
                        <label><input type="radio" name="coupon_type" value="referral"> 紹介割引：−500円</label>
                        <label class="percent-coupon-label"><input type="radio" name="coupon_type" value="percent"> <input type="number" id="percent-off-value" value="0" max="99" min="0" name="percent_off_value" placeholder="0-99">％OFFクーポン</label>
                        <label><input type="radio" name="coupon_type" value="none" checked> クーポンは持っていない</label>
                    </div>
                </div>
                <div class="input-group">
                    <label for="payment_method" class="required">お支払い方法<span class="asterisk">*</span></label>
                    <select id="payment_method" name="payment_method" required>
                        <option value="">選択してください</option>
                        <option value="銀行振込">銀行振込</option>
                        <option value="PayPay">PayPay</option>
                        <option value="PayPal">PayPal</option>
                        <option value="クレジットカード">クレジットカード</option>
                        <option value="コンビニ払い">コンビニ払い(手数料220円)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="remarks">備考</label>
                    <textarea id="remarks" name="remarks" rows="3" placeholder="ご希望・ご質問があればご記入ください"></textarea>
                </div>
            </div>

            <div class="input-group confirmation-group">
                <p class="confirmation-title">ご確認事項</p>
                <div class="confirmation-item">
                    <p><strong>セッションについて</strong></p>
                    <p>セッション形式： 遠隔<br>ご予約： 日にち指定のみ（時間指定不可）</p>
                </div>
                <div class="confirmation-item">
                    <p><strong>納品日・営業時間</strong></p>
                    <p>納品日：セッション日より5営業日<br>営業時間： 9：00～17：00<br>休日：土日祝日、他指定日</p>
                </div>
                <div class="confirmation-item">
                    <p><strong>セッション後の追加料金について</strong></p>
                    <p>納品後に追加のご質問がある場合は、以下の追加料金が発生する場合がございます。<br>追加質問: 3,000円～<br>鑑定対象者追加: 3,000円<br>霊視接続料: 10,000円</p>
                </div>
                <label class="agree-final"><input type="checkbox" name="agree_all" required> 上記内容にすべて同意します<span class="asterisk">*</span></label>
            </div>

            <div class="estimate">
                <p class="estimate-title">お見積り内容</p>
                <div id="selectedList" class="estimate-items"></div>
                <div class="estimate-total">
                    <p>合計金額：<span id="totalAmount">0</span>円</p>
                    <input type="hidden" name="total_amount" id="totalAmountHidden">
                </div>
            </div>

            <div id="validation-message" style="color: red; font-weight: bold; margin-top: 15px; text-align: center; display: none;"></div>

            <div class="center-btn">
                <button type="button" id="clearBtn" class="bg-[var(--color-text-light)] hover:bg-[var(--color-text)]">クリア</button>
                <button type="button" id="copyBtn" class="bg-[var(--color-accent)] hover:bg-[var(--color-accent-darker)]">コピー</button>
                <!-- LINEボタンのテキストと、その下の説明文を変更 -->
                <a href="https://line.me/ti/p/Kv76GQK_UI" id="lineSubmitBtn" class="line-button" target="_blank">LINEに貼り付けて予約</a>
                <!-- LINEの説明をボタンの下に移動 -->
                <div class="line-instructions-container">
                    <p>【LINEで予約する際の手順】</p>
                    <p>① お見積り内容にご了承いただけましたら、コピーボタンを押し、お見積り内容をコピーしてください。</p>
                    <p>② 「LINEに貼り付けて予約する」ボタンを押し、起動したLINEに貼り付けて送信ください。</p>
                </div>
            </div>

        </form>

        <div class="first-time-user-section">
            <h2>はじめての方へ</h2>
            <p>はじめての方は、以下のフォームにご記入お願いいたします。<br>リピーター様も未入力の方はご記入お願いいたします。</p>
            <a href="https://spiritual-therapist-mii.studio.site/form" class="form-button" id="firstTimeUserBtn" target="_blank">はじめての方のフォーム</a>
        </div>
    </main>

    <!-- フッター -->
    <footer class="bg-[var(--color-base)] text-[var(--color-text)] py-8 mt-20 w-full">
        <div class="container mx-auto text-center text-sm">
            <p>&copy; 2024 by Therapist Mii. All rights reserved.</p>
            <div class="flex justify-center gap-x-4 mt-2">
                <a href="privacy.html" class="text-[var(--color-text)] hover:text-[var(--color-accent)] transition-colors duration-300">プライバシーポリシー</a>
                <span class="text-[var(--color-text)]">|</span>
                <a href="tokusho.html" class="text-[var(--color-text)] hover:text-[var(--color-accent)] transition-colors duration-300">特定商取引法に基づく表記</a>
            </div>
        </div>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ハンバーガーメニューの開閉機能 (既存サイトから継承) ---
            const menuToggle = document.getElementById('menu-toggle');
            const offCanvasMenu = document.getElementById('off-canvas-menu');
            const menuOverlay = document.getElementById('menu-overlay');
            const closeMenuBtn = document.getElementById('close-menu');
            const menuLinks = offCanvasMenu.querySelectorAll('ul li a'); // メニュー内のリンクを取得

            function toggleMenu() {
                offCanvasMenu.classList.toggle('open');
                menuOverlay.classList.toggle('open');
            }

            menuToggle.addEventListener('click', toggleMenu);
            closeMenuBtn.addEventListener('click', toggleMenu);
            menuOverlay.addEventListener('click', toggleMenu); // Overlayクリックでメニューを閉じる

            // メニュー内のリンクをクリックした時もメニューを閉じる
            menuLinks.forEach(link => {
                link.addEventListener('click', (event) => {
                    const href = link.getAttribute('href');
                    // 'index.html' または 'menu.html' へのリンクは通常遷移
                    if (href.startsWith('index.html') || href.startsWith('menu.html')) {
                        // ページ内リンクであればスムーズスクロール
                        if (href.includes('#')) {
                            event.preventDefault();
                            const [page, targetId] = href.split('#');
                            if (page === 'index.html' || window.location.pathname.endsWith(page)) {
                                document.querySelector(`#${targetId}`).scrollIntoView({ behavior: 'smooth' });
                            } else {
                                window.location.href = href; // 別のページへのセクションリンク
                            }
                        } else {
                            // ページ全体へのリンク
                            window.location.href = href;
                        }
                    } else if (href === 'reservation.html' || href === 'reading-reservation.html') {
                        // 現在のページへのリンクであれば、単にメニューを閉じる
                        event.preventDefault(); // デフォルトの動作をキャンセルしてページリロードを防ぐ
                        // 必要であればトップにスクロール
                        document.querySelector('main').scrollIntoView({ behavior: 'smooth', block: 'start' });
                    }
                    toggleMenu(); // メニューを閉じる
                });
            });

            // スクロール時のフェードインアニメーション用JavaScript (既存サイトから継承)
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1 /* 要素の10%が見えたら発火 */
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target); // 一度表示されたら監視を停止
                    }
                });
            }, observerOptions);

            // スクロールで出現させる要素を全て監視
            document.querySelectorAll('.fade-in-on-scroll, .slide-in-left-on-scroll, .slide-in-right-on-scroll').forEach(element => {
                observer.observe(element);
            });


            // --- 予約フォームのロジック (booking-reading.htmlのscript.jsを統合・調整) ---
            const reservationForm = document.getElementById('reservationForm');
            const requesterNameInput = document.getElementById('requesterNameInput');
            const relatedNameList = document.getElementById('relatedNameList');
            const questionList = document.getElementById('questionList');
            const addRelatedNameBtn = document.getElementById('addRelatedNameBtn');
            const addQuestionBtn = document.getElementById('addQuestionBtn');
            const relatedNameCountEl = document.getElementById('relatedNameCount');
            const noRelatedCheckbox = document.getElementById('noRelatedCheckbox');
            
            const agreeLightDiscountCheckbox = document.getElementById('agree-light-discount');
            const lightDiscountQtyInput = document.querySelector('input[name="light_discount_qty"]');
            const lightDiscountControls = lightDiscountQtyInput.closest('.controls.option');

            const percentOffValueInput = document.getElementById('percent-off-value');
            const selectedList = document.getElementById('selectedList');
            const totalEl = document.getElementById('totalAmount');
            const totalAmountHidden = document.getElementById('totalAmountHidden');

            const copyBtn = document.getElementById('copyBtn');
            const clearBtn = document.getElementById('clearBtn');
            const lineSubmitBtn = document.getElementById('lineSubmitBtn');
            const validationMessageEl = document.getElementById('validation-message');

            // --- Constants ---
            const READING_FEE = 13000; // リーディングの基本料金に変更
            const RELATED_PERSON_FEE = 3000;
            const CONVENIENCE_STORE_FEE = 220; // コンビニ払い手数料を追加
            const MAX_RELATED_NAMES = 5;
            const MAX_QUESTIONS = 10;

            // --- Helper Functions ---
            const formatPrice = (amount) => new Intl.NumberFormat('ja-JP').format(amount); // 円記号は合計表示のみ

            function reindexInputs() {
                relatedNameList.querySelectorAll('.dynamic-item input').forEach((input, index) => {
                    input.name = `related_name_${index}`;
                    input.placeholder = `関係者 ${index + 1}`;
                });

                questionList.querySelectorAll('.question-block').forEach((block, index) => {
                    const categorySelect = block.querySelector('.consultation-category');
                    categorySelect.name = `category_${index}`;
                    categorySelect.id = `consultation-category-${index}`;
                    block.querySelector('label[for^="consultation-category"]').htmlFor = `consultation-category-${index}`;
                    block.querySelector('textarea').name = `question_${index}`;

                    let removeBtn = block.querySelector('.remove-item');
                    if (index > 0) {
                        if (!removeBtn) {
                            removeBtn = createRemoveButton();
                            block.querySelector('.controls').appendChild(removeBtn);
                        }
                        removeBtn.style.display = 'inline-block';
                    } else if (removeBtn) {
                        removeBtn.style.display = 'none';
                    }
                });
                updateAllQuantityDisplays();
            }

            function updateAllQuantityDisplays() {
                document.querySelectorAll('.controls.option').forEach(ctrl => {
                    const input = ctrl.querySelector('input[type="number"]');
                    const qtySpan = ctrl.querySelector('.qty strong');
                    if (input && qtySpan) qtySpan.textContent = input.value;
                });
                relatedNameCountEl.textContent = relatedNameList.querySelectorAll('.dynamic-item').length;
            }

            function recount() {
                let subtotal = 0;
                selectedList.innerHTML = '';

                // お名前（霊視接続料）は必須のため、常に加算
                subtotal += READING_FEE;
                selectedList.innerHTML += `<li><span>お名前（霊視接続料）</span><span>${formatPrice(READING_FEE)} 円</span></li>`;

                if (!noRelatedCheckbox.checked) {
                    relatedNameList.querySelectorAll('input[type="text"]').forEach(input => {
                        if (input.value.trim()) { // 入力がある場合のみ加算
                            subtotal += RELATED_PERSON_FEE;
                            selectedList.innerHTML += `<li><span>関係者: ${input.value.trim()}</span><span>${formatPrice(RELATED_PERSON_FEE)} 円</span></li>`;
                        }
                    });
                }

                questionList.querySelectorAll('.question-block').forEach((block, index) => {
                    const categorySelect = block.querySelector('select');
                    const textarea = block.querySelector('textarea');
                    const selectedOption = categorySelect.options[categorySelect.selectedIndex];
                    // カテゴリと内容の両方が入力されている場合のみ加算
                    if (textarea.value.trim() && selectedOption && selectedOption.value) {
                        const price = parseInt(selectedOption.dataset.price) || 0;
                        subtotal += price;
                        selectedList.innerHTML += `<li><span>相談内容${index + 1}: ${selectedOption.text.replace(/（.*）/, '')}</span><span>${formatPrice(price)} 円</span></li>`;
                    }
                });

                document.querySelectorAll('#options input[type="number"]').forEach(input => {
                    const qty = parseInt(input.value) || 0;
                    if (qty !== 0) { // 数量が0でない場合のみ加算 (ライト割引はマイナス値)
                        const price = parseInt(input.dataset.price);
                        // ライト割引は数量が1以上であれば常に1として計算
                        const effectiveQty = (input.name === 'light_discount_qty' && qty > 0) ? 1 : qty;
                        subtotal += price * effectiveQty;
                        if (price > 0) {
                            selectedList.innerHTML += `<li><span>${input.dataset.label} × ${effectiveQty}</span><span>${formatPrice(price * effectiveQty)} 円</span></li>`;
                        } else {
                            selectedList.innerHTML += `<li><span>${input.dataset.label}</span><span>${formatPrice(price * effectiveQty)} 円</span></li>`;
                        }
                    }
                });
                
                let finalTotal = subtotal;
                const selectedCoupon = document.querySelector('input[name="coupon_type"]:checked')?.value;
                if (selectedCoupon === 'referral') {
                    finalTotal -= 500;
                    selectedList.innerHTML += `<li><span>紹介割引</span><span>${formatPrice(-500)} 円</span></li>`;
                } else if (selectedCoupon === 'percent') {
                    const percent = parseInt(percentOffValueInput.value) || 0;
                    if (percent > 0 && percent <= 100) { // 0%や100%超は考慮しない
                        const discount = Math.round(subtotal * (percent / 100));
                        finalTotal -= discount;
                        selectedList.innerHTML += `<li><span>${percent}% OFF クーポン</span><span>${formatPrice(-discount)} 円</span></li>`;
                    }
                }

                if (document.getElementById('payment_method').value === 'コンビニ払い') {
                    finalTotal += CONVENIENCE_STORE_FEE;
                    selectedList.innerHTML += `<li><span>コンビニ払い手数料</span><span>${formatPrice(CONVENIENCE_STORE_FEE)} 円</span></li>`;
                }

                // 合計金額がマイナスにならないようにする
                finalTotal = Math.max(0, finalTotal);

                totalEl.textContent = formatPrice(finalTotal);
                totalAmountHidden.value = finalTotal;
            }

            function validateForm() {
                let isValid = true;
                let firstErrorElement = null;
                validationMessageEl.textContent = '';
                validationMessageEl.style.display = 'none';
                document.querySelectorAll('.error-highlight').forEach(el => el.classList.remove('error-highlight'));

                const addError = (element, message) => {
                    isValid = false;
                    element.classList.add('error-highlight');
                    if (!firstErrorElement) {
                        firstErrorElement = element;
                        validationMessageEl.textContent = message;
                        validationMessageEl.style.display = 'block';
                    }
                };

                if (!requesterNameInput.value.trim()) {
                    addError(requesterNameInput, 'お名前は必須です。');
                }
                
                const questionBlocks = questionList.querySelectorAll('.question-block');
                questionBlocks.forEach((block, index) => {
                    const categorySelect = block.querySelector('.consultation-category');
                    const textarea = block.querySelector('textarea');
                    if (!categorySelect.value || !textarea.value.trim()) {
                        addError(block, `相談内容${index + 1}はカテゴリ選択と内容記入の両方が必須です。`);
                    }
                });


                const relatedInputs = relatedNameList.querySelectorAll('input[type="text"]');
                const hasRelatedInput = Array.from(relatedInputs).some(input => input.value.trim() !== '');
                if (!noRelatedCheckbox.checked && !hasRelatedInput) {
                    addError(relatedNameList.closest('.input-group'), '関係者名を追加するか、「関係者はいません」にチェックしてください。');
                }

                if (!document.querySelector('input[name="coupon_type"]:checked')) {
                    addError(document.getElementById('coupon-group'), 'クーポンの有無を選択してください。');
                }
                
                if (!document.getElementById('payment_method').value) {
                    addError(document.getElementById('payment_method'), 'お支払い方法は必須です。');
                }
                
                if (!document.querySelector('input[name="agree_all"]').checked) {
                    addError(document.querySelector('.agree-final'), 'ご確認事項への同意は必須です。');
                }

                if (!isValid && firstErrorElement) {
                    firstErrorElement.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                return isValid;
            }

            function createRemoveButton() {
                const button = document.createElement('button');
                button.type = 'button';
                button.className = 'remove-item';
                button.innerHTML = '&times;';
                button.addEventListener('click', (e) => {
                    e.target.closest('.dynamic-item, .question-block')?.remove();
                    reindexInputs();
                    recount();
                });
                return button;
            }
            
            function resetForm() {
                reservationForm.reset();
                relatedNameList.innerHTML = ''; // 関係者をクリア
                while (questionList.children.length > 1) { // 最初の相談内容以外をクリア
                    questionList.removeChild(questionList.lastChild);
                }
                // 最初の相談内容の入力もクリア
                questionList.querySelector('.consultation-category').value = '';
                questionList.querySelector('textarea').value = '';

                document.querySelectorAll('.error-highlight').forEach(el => el.classList.remove('error-highlight'));
                validationMessageEl.style.display = 'none';
                agreeLightDiscountCheckbox.checked = false;
                lightDiscountQtyInput.value = 0;
                lightDiscountQtyInput.disabled = true;
                lightDiscountControls.querySelectorAll('button').forEach(btn => btn.disabled = true);
                
                // クーポンもリセット
                document.querySelector('input[name="coupon_type"][value="none"]').checked = true;
                percentOffValueInput.value = 0;
                percentOffValueInput.disabled = true; // パーセント割引の入力欄も無効化
                
                reindexInputs(); // 要素を再インデックス
                updateAllQuantityDisplays(); // 数量表示を更新
                recount(); // 金額を再計算
            }
            
            function generateEstimateText() {
                recount(); // 最新の状態を反映
                let text = '【リーディングお申し込み内容】\n\n';
                
                document.querySelectorAll('#selectedList li').forEach(li => {
                    const itemText = li.querySelector('span:first-child').textContent.trim();
                    const itemPrice = li.querySelector('span:last-child').textContent.trim();
                    text += `${itemText}  ${itemPrice}\n`;
                });

                text += `\n--------------------------------\n`;
                text += `合計金額: ${document.getElementById('totalAmount').textContent.trim()}円\n`;
                text += `--------------------------------\n\n`;

                text += `お名前: ${requesterNameInput.value.trim()}\n`;

                // 相談内容
                questionList.querySelectorAll('.question-block').forEach((block, index) => {
                    const categorySelect = block.querySelector('.consultation-category');
                    const textarea = block.querySelector('textarea');
                    const categoryText = categorySelect.value ? categorySelect.options[categorySelect.selectedIndex].text.replace(/（.*）/, '') : '未選択';
                    const questionText = textarea.value.trim();
                    text += `相談内容${index + 1} カテゴリ: ${categoryText}\n`;
                    text += `相談内容${index + 1} 要点: ${questionText || '未記入'}\n`;
                });

                // 関係者のお名前
                const relatedNames = Array.from(relatedNameList.querySelectorAll('input[type="text"]'))
                                        .map(input => input.value.trim())
                                        .filter(name => name !== '');
                if (noRelatedCheckbox.checked) {
                    text += `関係者: いません\n`;
                } else if (relatedNames.length > 0) {
                    text += `関係者: ${relatedNames.join(', ')}\n`;
                } else {
                    text += `関係者: 未入力\n`;
                }

                // オプション
                const optionsSelected = [];
                document.querySelectorAll('#options input[type="number"]').forEach(input => {
                    const qty = parseInt(input.value) || 0;
                    if (qty !== 0) {
                        const label = input.dataset.label;
                        if (input.name === 'light_discount_qty' && qty > 0) {
                            optionsSelected.push(label); // ライト割引は「適用」なので数量表示なし
                        } else if (qty > 0) {
                            optionsSelected.push(`${label} × ${qty}`);
                        }
                    }
                });
                if (optionsSelected.length > 0) {
                    text += `オプション: ${optionsSelected.join(', ')}\n`;
                } else {
                    text += `オプション: なし\n`;
                }

                // クーポン
                const selectedCouponRadio = document.querySelector('input[name="coupon_type"]:checked');
                if (selectedCouponRadio) {
                    if (selectedCouponRadio.value === 'referral') {
                        text += `クーポン: 紹介割引\n`;
                    } else if (selectedCouponRadio.value === 'percent') {
                        const percent = parseInt(percentOffValueInput.value) || 0;
                        text += `クーポン: ${percent}% OFF\n`;
                    } else {
                        text += `クーポン: なし\n`;
                    }
                }

                const paymentSelect = document.getElementById('payment_method');
                const paymentMethod = paymentSelect.value ? paymentSelect.options[paymentSelect.selectedIndex].text : '未選択';
                text += `お支払い方法: ${paymentMethod}\n`;

                const remarks = document.getElementById('remarks').value.trim();
                if (remarks) {
                    text += `備考:\n${remarks}\n`;
                }
                
                text += '\n上記の内容で申し込みます。';
                return text;
            }

            // --- Event Listeners ---
            addRelatedNameBtn.addEventListener('click', () => {
                if (relatedNameList.querySelectorAll('.dynamic-item').length < MAX_RELATED_NAMES) {
                    const newItem = document.createElement('div');
                    newItem.className = 'dynamic-item';
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.required = !noRelatedCheckbox.checked; // 関係者がいないチェックが入ってない場合は必須に
                    newItem.appendChild(input);
                    newItem.appendChild(createRemoveButton());
                    relatedNameList.appendChild(newItem);
                    noRelatedCheckbox.checked = false; // 関係者追加時は「関係者はいません」をオフに
                    reindexInputs();
                    recount();
                }
            });

            addQuestionBtn.addEventListener('click', () => {
                if (questionList.querySelectorAll('.question-block').length < MAX_QUESTIONS) {
                    const newBlock = questionList.querySelector('.question-block').cloneNode(true);
                    newBlock.querySelector('select').value = ''; // 選択をクリア
                    newBlock.querySelector('textarea').value = ''; // テキストエリアをクリア
                    questionList.appendChild(newBlock);
                    reindexInputs();
                    recount();
                }
            });

            noRelatedCheckbox.addEventListener('change', (e) => {
                addRelatedNameBtn.disabled = e.target.checked;
                if (e.target.checked) {
                    relatedNameList.innerHTML = ''; // チェックが入ったら関係者リストをクリア
                }
                reindexInputs();
                recount();
            });

            // フォームの入力値が変更されたら再計算
            reservationForm.addEventListener('input', (e) => {
                // テキストエリア以外の入力でリアルタイム更新
                if (e.target.tagName !== 'TEXTAREA' || e.target.name === 'remarks') {
                    recount();
                }
            });
            reservationForm.addEventListener('change', recount); // selectやcheckboxなどの変更時

            // オプションの数量ボタンのイベントリスナー
            document.querySelectorAll('.controls.option button').forEach(ctrlBtn => {
                ctrlBtn.addEventListener('click', (e) => {
                    const input = e.target.closest('.controls.option').querySelector('input[type="number"]');
                    if (input.disabled) return;
                    const currentVal = parseInt(input.value);
                    if (e.target.classList.contains('plus')) {
                        input.value = Math.min(currentVal + 1, parseInt(input.max || 99)); // max属性も考慮
                    } else if (e.target.classList.contains('minus')) {
                        input.value = Math.max(currentVal - 1, parseInt(input.min || 0)); // min属性も考慮
                    }
                    updateAllQuantityDisplays();
                    recount();
                });
            });

            // ライト割引のチェックボックスにイベントリスナー
            agreeLightDiscountCheckbox.addEventListener('change', () => {
                const isAgreed = agreeLightDiscountCheckbox.checked;
                lightDiscountQtyInput.disabled = !isAgreed;
                lightDiscountControls.querySelectorAll('button').forEach(btn => btn.disabled = !isAgreed);
                lightDiscountQtyInput.value = isAgreed ? 1 : 0; // 同意したら1、そうでなければ0
                updateAllQuantityDisplays();
                recount();
            });

            // クーポンラジオボタンの変更を監視し、パーセンテージ入力欄の有効/無効を切り替える
            document.querySelectorAll('input[name="coupon_type"]').forEach(radio => {
                radio.addEventListener('change', () => {
                    percentOffValueInput.disabled = (radio.value !== 'percent');
                    if (radio.value !== 'percent') {
                        percentOffValueInput.value = 0; // パーセントクーポンでなければ値をリセット
                    }
                    recount();
                });
            });


            // クリアボタン
            clearBtn.addEventListener('click', resetForm);
            
            // コピーボタン
            copyBtn.addEventListener('click', () => {
                if (!validateForm()) return; // バリデーションに失敗したら処理を中断
                
                const estimateText = generateEstimateText();
                // alertの代わりにカスタムメッセージボックスを使用
                // navigator.clipboard.writeText().then().catch() を使用
                document.execCommand('copy', false, estimateText); // For clipboard.writeText() alternatives
                showCustomMessage('申込内容をコピーしました！');
            });

            // LINE送信ボタン (hrefは直接LINEのURLを指定)
            lineSubmitBtn.addEventListener('click', (e) => {
                // デフォルトのリンク遷移を防ぐ。コピー処理は別途行うため。
                // e.preventDefault(); // LINEに直接飛ぶため不要

                if (!validateForm()) {
                    e.preventDefault(); // バリデーション失敗時はLINEに飛ばさない
                    return;
                }
                
                const estimateText = generateEstimateText();
                document.execCommand('copy', false, estimateText); // For clipboard.writeText() alternatives
                showCustomMessage('申込内容をコピーしました。LINEアプリに貼り付けて送信してください。');
            });

            // フォーム送信ボタン（予約内容を確認する）
            reservationForm.addEventListener('submit', (e) => {
                e.preventDefault(); // デフォルトのフォーム送信を停止
                if (validateForm()) {
                    const confirmationMessage = generateEstimateText();
                    showCustomMessage("以下の内容で予約を承ります。\n\n" + confirmationMessage, "予約内容の確認");
                    // ここに実際の予約送信処理（API呼び出しなど）を追加
                }
            });

            // カスタムアラート/メッセージボックス関数
            function showCustomMessage(message, title = "お知らせ") {
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    background-color: rgba(0,0,0,0.5);
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    z-index: 9999;
                `;

                const modalContent = document.createElement('div');
                modalContent.style.cssText = `
                    background-color: white;
                    padding: 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
                    max-width: 90%;
                    width: 400px;
                    text-align: center;
                    font-family: 'Shippori Mincho', serif;
                    color: var(--color-text);
                    white-space: pre-wrap;
                    word-break: break-word;
                    max-height: 80vh;
                    overflow-y: auto;
                `;

                const modalTitle = document.createElement('h3');
                modalTitle.textContent = title;
                modalTitle.style.cssText = `
                    font-size: 1.5em;
                    margin-bottom: 15px;
                    color: var(--color-accent);
                `;

                const modalBody = document.createElement('p');
                modalBody.textContent = message;
                modalBody.style.cssText = `
                    margin-bottom: 20px;
                    line-height: 1.6;
                    font-size: 0.95em;
                    text-align: left;
                `;

                const modalButton = document.createElement('button');
                modalButton.textContent = '閉じる';
                modalButton.style.cssText = `
                    background-color: var(--color-accent);
                    color: white;
                    padding: 10px 20px;
                    border: none;
                    border-radius: 5px;
                    cursor: pointer;
                    font-size: 1em;
                `;
                modalButton.addEventListener('click', () => {
                    document.body.removeChild(modal);
                });

                modalContent.appendChild(modalTitle);
                modalContent.appendChild(modalBody);
                modalContent.appendChild(modalButton);
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            }

            // 初回ロード時の設定
            resetForm(); // 全てのリセットと初回計算を行う
        });
    </script>
</body>
</html>
